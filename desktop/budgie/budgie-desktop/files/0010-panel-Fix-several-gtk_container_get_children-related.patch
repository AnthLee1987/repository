From 888d89a35724e78f1044ec0daa1450aff1bf726e Mon Sep 17 00:00:00 2001
From: Ikey Doherty <ikey.doherty@gmail.com>
Date: Thu, 10 Jul 2014 00:15:59 +0100
Subject: [PATCH 10/22] panel: Fix several gtk_container_get_children related
 memory leaks

---
 panel/applets/menu-window.c | 3 +++
 panel/icon-tasklist.c       | 2 ++
 2 files changed, 5 insertions(+)

diff --git a/panel/applets/menu-window.c b/panel/applets/menu-window.c
index d6d2e67..74de644 100644
--- a/panel/applets/menu-window.c
+++ b/panel/applets/menu-window.c
@@ -461,6 +461,7 @@ static void activate_cb(GtkWidget *widget, gpointer userdata)
                         break;
                 }
         }
+        g_list_free(kids);
         if (!selected) {
                 return;
         }
@@ -488,6 +489,7 @@ static void menu_changed(GMenuTree *tree, gpointer userdata)
         for (elem = kids; elem != NULL; elem = elem->next) {
                 gtk_widget_destroy(GTK_WIDGET(elem->data));
         }
+        g_list_free(kids);
 
         /* Remove everything but the "all" button in the categories */
         kids = gtk_container_get_children(GTK_CONTAINER(self->priv->group_box));
@@ -496,6 +498,7 @@ static void menu_changed(GMenuTree *tree, gpointer userdata)
                         gtk_widget_destroy(GTK_WIDGET(elem->data));
                 }
         }
+        g_list_free(kids);
 
         /* We're done - reload menus */
         populate_menu(self, NULL);
diff --git a/panel/icon-tasklist.c b/panel/icon-tasklist.c
index 47c16fe..3cf044a 100644
--- a/panel/icon-tasklist.c
+++ b/panel/icon-tasklist.c
@@ -290,6 +290,7 @@ static void window_closed(WnckScreen *screen,
                         gtk_widget_destroy(toggle);
                 }
         }
+        g_list_free(list);
 }
 
 static void active_changed(WnckScreen *screen,
@@ -325,6 +326,7 @@ static void active_changed(WnckScreen *screen,
                                 bwindow == active);
                 }
         }
+        g_list_free(list);
 }
 
 static void update_window_icon(GtkImage *image,
-- 
1.9.1

